#!/usr/bin/env bash
logger "Connected wiht z2m!"
logger "$(ls ${SNAP_DATA})"

SNAP_CONFIG="$(snapctl get --plug :store-dir z2mconfig)"

if [ -n "${SNAP_CONFIG}" ]; then
	echo "${SNAP_CONFIG}"
	logger "${SNAP_CONFIG}"
	echo "${SNAP_CONFIG}" > "${SNAP_DATA}/.snap.config"
	if [ "$(snapctl get --plug :store-dir z2mserial)" -eq 1 ]; then
		echo "Serial-port is enabled on Z2M, wont enable ${SNAP_NAME} automatically. Connect interface and enable ZUI with Â«sudo zwave-js-ui.enable"
		logger "${SNAP_NAME}: Serial-port is enabled on Z2M, wont enable zui before manually connected."
	else
		echo "Enabling ZUI"
		logger "Enabling ZUI"
		snapctl start --enable "${SNAP_NAME}.${SNAP_NAME}"
	fi
else
	echo "Do not have snap plug config"
	logger "Do not have snap plug config"
fi


